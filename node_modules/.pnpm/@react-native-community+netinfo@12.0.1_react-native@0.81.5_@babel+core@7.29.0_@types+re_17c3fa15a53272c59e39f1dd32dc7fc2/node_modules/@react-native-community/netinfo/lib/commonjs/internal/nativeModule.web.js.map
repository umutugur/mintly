{"version":3,"names":["_privateTypes","require","_types","isWindowPresent","window","connection","hasOwnProperty","navigator","mozConnection","webkitConnection","undefined","typeMapping","bluetooth","NetInfoStateType","cellular","ethernet","none","other","unknown","wifi","wimax","mixed","effectiveTypeMapping","NetInfoCellularGeneration","getCurrentState","_requestedInterface","isConnected","onLine","baseState","isInternetReachable","state","type","details","isConnectionExpensive","saveData","cellularGeneration","effectiveType","carrier","ipAddress","subnet","ssid","bssid","strength","frequency","linkSpeed","rxLinkSpeed","txLinkSpeed","handlers","nativeHandlers","RNCNetInfo","addListener","handler","DEVICE_CONNECTIVITY_EVENT","nativeHandler","addEventListener","push","removeListeners","index","indexOf","removeEventListener","splice","requestedInterface","configure","_default","exports","default"],"sources":["nativeModule.web.ts"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n */\n\nimport {\n  DEVICE_CONNECTIVITY_EVENT,\n  NetInfoNativeModule,\n  NetInfoNativeModuleState,\n} from './privateTypes';\nimport {\n  NetInfoBluetoothState,\n  NetInfoCellularGeneration,\n  NetInfoCellularState,\n  NetInfoEthernetState,\n  NetInfoNoConnectionState,\n  NetInfoOtherState,\n  NetInfoState,\n  NetInfoStateType,\n  NetInfoUnknownState,\n  NetInfoWifiState,\n  NetInfoWimaxState,\n} from './types';\n\n// See https://wicg.github.io/netinfo/#dom-connectiontype\ntype ConnectionType =\n  | 'bluetooth'\n  | 'cellular'\n  | 'ethernet'\n  | 'mixed'\n  | 'none'\n  | 'other'\n  | 'unknown'\n  | 'wifi'\n  | 'wimax';\n\n// See https://wicg.github.io/netinfo/#dom-effectiveconnectiontype\ntype ConnectionEffectiveType = '2g' | '3g' | '4g' | 'slow-2g';\n\n// https://wicg.github.io/netinfo/#dom-networkinformation-savedata\ntype ConnectionSaveData = boolean;\n\ninterface Events {\n  change: Event;\n}\n\ninterface Connection {\n  type: ConnectionType;\n  effectiveType: ConnectionEffectiveType;\n  saveData: ConnectionSaveData;\n  addEventListener<K extends keyof Events>(\n    type: K,\n    listener: (event: Events[K]) => void,\n  ): void;\n  removeEventListener<K extends keyof Events>(\n    type: K,\n    listener: (event: Events[K]) => void,\n  ): void;\n}\n\n// Create (optional) connection APIs on navigator\ndeclare global {\n  interface Navigator {\n    connection?: Connection;\n    mozConnection?: Connection;\n    webkitConnection?: Connection;\n  }\n}\n// Use a constant test of this form because in SSR on next.js, optional chaining is not sufficient,\n// but this test correctly detects that window is not available and allows for conditionals before access\nconst isWindowPresent = typeof window !== 'undefined';\n\n// Check if window exists and if the browser supports the connection API\nconst connection = (isWindowPresent && !window.hasOwnProperty('tizen') && !window.hasOwnProperty('webOS'))\n  ? window.navigator.connection ||\n    window.navigator.mozConnection ||\n    window.navigator.webkitConnection\n  : undefined;\n\n// Map browser types to native types\nconst typeMapping: Record<ConnectionType, NetInfoStateType> = {\n  bluetooth: NetInfoStateType.bluetooth,\n  cellular: NetInfoStateType.cellular,\n  ethernet: NetInfoStateType.ethernet,\n  none: NetInfoStateType.none,\n  other: NetInfoStateType.other,\n  unknown: NetInfoStateType.unknown,\n  wifi: NetInfoStateType.wifi,\n  wimax: NetInfoStateType.wimax,\n  mixed: NetInfoStateType.other,\n};\nconst effectiveTypeMapping: Record<\n  ConnectionEffectiveType,\n  NetInfoCellularGeneration\n> = {\n  '2g': NetInfoCellularGeneration['2g'],\n  '3g': NetInfoCellularGeneration['3g'],\n  '4g': NetInfoCellularGeneration['4g'],\n  'slow-2g': NetInfoCellularGeneration['2g'],\n};\n\n// Determine current state of connection\nconst getCurrentState = (\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  _requestedInterface?: string,\n): Pick<NetInfoState, Exclude<keyof NetInfoState, 'isInternetReachable'>> => {\n  const isConnected = isWindowPresent ? navigator.onLine : false;\n  const baseState = {\n    isInternetReachable: null,\n  };\n\n  // If we don't have a connection object, we return minimal information\n  if (!connection) {\n    if (isConnected) {\n      const state: NetInfoOtherState = {\n        ...baseState,\n        isConnected: true,\n        type: NetInfoStateType.other,\n        details: {\n          isConnectionExpensive: false,\n        },\n      };\n      return state;\n    }\n\n    const state: NetInfoNoConnectionState = {\n      ...baseState,\n      isConnected: false,\n      isInternetReachable: false,\n      type: NetInfoStateType.none,\n      details: null,\n    };\n    return state;\n  }\n\n  // Otherwise try to return detailed information\n  const isConnectionExpensive = connection.saveData;\n  const type: NetInfoStateType = connection.type\n    ? typeMapping[connection.type]\n    : isConnected\n    ? NetInfoStateType.other\n    : NetInfoStateType.unknown;\n\n  if (type === NetInfoStateType.bluetooth) {\n    const state: NetInfoBluetoothState = {\n      ...baseState,\n      isConnected: true,\n      type,\n      details: {\n        isConnectionExpensive,\n      },\n    };\n    return state;\n  } else if (type === NetInfoStateType.cellular) {\n    const state: NetInfoCellularState = {\n      ...baseState,\n      isConnected: true,\n      type,\n      details: {\n        isConnectionExpensive,\n        cellularGeneration:\n          effectiveTypeMapping[connection.effectiveType] || null,\n        carrier: null,\n      },\n    };\n    return state;\n  } else if (type === NetInfoStateType.ethernet) {\n    const state: NetInfoEthernetState = {\n      ...baseState,\n      isConnected: true,\n      type,\n      details: {\n        isConnectionExpensive,\n        ipAddress: null,\n        subnet: null,\n      },\n    };\n    return state;\n  } else if (type === NetInfoStateType.wifi) {\n    const state: NetInfoWifiState = {\n      ...baseState,\n      isConnected: true,\n      type,\n      details: {\n        isConnectionExpensive,\n        ssid: null,\n        bssid: null,\n        strength: null,\n        ipAddress: null,\n        subnet: null,\n        frequency: null,\n        linkSpeed: null,\n        rxLinkSpeed: null,\n        txLinkSpeed: null,\n      },\n    };\n    return state;\n  } else if (type === NetInfoStateType.wimax) {\n    const state: NetInfoWimaxState = {\n      ...baseState,\n      isConnected: true,\n      type,\n      details: {\n        isConnectionExpensive,\n      },\n    };\n    return state;\n  } else if (type === NetInfoStateType.none) {\n    const state: NetInfoNoConnectionState = {\n      ...baseState,\n      isConnected: false,\n      isInternetReachable: false,\n      type,\n      details: null,\n    };\n    return state;\n  } else if (type === NetInfoStateType.unknown) {\n    const state: NetInfoUnknownState = {\n      ...baseState,\n      isConnected,\n      isInternetReachable: null,\n      type,\n      details: null,\n    };\n    return state;\n  }\n\n  const state: NetInfoOtherState = {\n    ...baseState,\n    isConnected: true,\n    type: NetInfoStateType.other,\n    details: {\n      isConnectionExpensive,\n    },\n  };\n  return state;\n};\n\nconst handlers: ((state: NetInfoNativeModuleState) => void)[] = [];\nconst nativeHandlers: (() => void)[] = [];\n\nconst RNCNetInfo: NetInfoNativeModule = {\n  addListener(type, handler): void {\n    switch (type) {\n      case DEVICE_CONNECTIVITY_EVENT: {\n        const nativeHandler = (): void => {\n          handler(getCurrentState());\n        };\n\n        if (connection) {\n          connection.addEventListener('change', nativeHandler);\n        } else {\n          if (isWindowPresent) {\n            window.addEventListener('online', nativeHandler, false);\n            window.addEventListener('offline', nativeHandler, false);\n          }\n        }\n\n        // Remember handlers\n        handlers.push(handler);\n        nativeHandlers.push(nativeHandler);\n\n        break;\n      }\n    }\n  },\n\n  removeListeners(type, handler): void {\n    switch (type) {\n      case DEVICE_CONNECTIVITY_EVENT: {\n        // Get native handler\n        const index = handlers.indexOf(handler);\n        const nativeHandler = nativeHandlers[index];\n\n        if (connection) {\n          connection.removeEventListener('change', nativeHandler);\n        } else {\n          if (isWindowPresent) {\n            window.removeEventListener('online', nativeHandler);\n            window.removeEventListener('offline', nativeHandler);\n          }\n        }\n\n        // Remove handlers\n        handlers.splice(index, 1);\n        nativeHandlers.splice(index, 1);\n\n        break;\n      }\n    }\n  },\n\n  async getCurrentState(requestedInterface): Promise<NetInfoNativeModuleState> {\n    return getCurrentState(requestedInterface);\n  },\n\n  configure(): void {\n    return;\n  },\n};\n\nexport default RNCNetInfo;\n"],"mappings":"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"}