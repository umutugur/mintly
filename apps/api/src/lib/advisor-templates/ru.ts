import type { CategoryKey, TemplateBank } from './types.js';

function combine(first: readonly string[], second: readonly string[]): string[] {
  const out: string[] = [];
  for (const a of first) {
    for (const b of second) {
      out.push(`${a} ${b}`.replace(/\s+/g, ' ').trim());
    }
  }
  return out;
}

const ruAdviceSummaries: Record<CategoryKey, string[]> = {
  spending: combine(
    [
      'В {monthName} динамика расходов в основном формируется категорией {topCategory}.',
      'Структура трат за месяц показывает, что ключевое давление идёт из категории {topCategory}.',
      'Текущий расходный профиль сместился в сторону {topCategory}.',
      'В этом периоде именно {topCategory} задаёт темп расходам.',
    ],
    [
      'Недельный лимит поможет погасить отклонение на уровне {spendDeltaPct}%.',
      'Ранние точечные корректировки обычно дают лучший результат, чем жёсткие поздние ограничения.',
    ],
  ),
  income: combine(
    [
      'Доход в {monthName} изменился на {incomeDeltaPct}%, и это влияет на весь финансовый план.',
      'Сдвиг входящего потока на {incomeDeltaPct}% требует сценарного подхода к бюджету.',
      'Текущая динамика дохода стала важным фактором для ежемесячных решений.',
      'Профиль поступлений изменился, поэтому стоит пересобрать приоритеты по расходам.',
    ],
    [
      'Лучше направить этот эффект в резерв и цели, а не в расширение текущих трат.',
      'Такой подход снижает риск просадки при следующем колебании дохода.',
    ],
  ),
  savings: combine(
    [
      'Текущая норма сбережений держится около {savingsRatePct}%, и это уже рабочая база.',
      'Поведение в части накоплений выглядит стабильным и поддаётся масштабированию.',
      'Снимок за {monthName} показывает устойчивый контур сбережений.',
      'Накопительная дисциплина сформирована, теперь важен ритм исполнения.',
    ],
    [
      'Автоматический график переводов поможет приблизиться к цели {targetSavingsRatePct}%.',
      'Регулярные небольшие переводы обычно работают надёжнее редких крупных решений.',
    ],
  ),
  risk: combine(
    [
      'Риск-сигналы в этом месяце в основном операционные: скорость, повторяемость и выход к порогам.',
      'Профиль риска остаётся управляемым, но ранние индикаторы уже заметны.',
      'Текущая картина требует профилактики, а не реактивных мер в конце месяца.',
      'Риск распределён по нескольким привычкам, а не сосредоточен в одной статье.',
    ],
    [
      'Если опустить пороги оповещений заранее, стоимость исправления будет ниже.',
      'Ранняя реакция обычно снижает волатильность без жёстких ограничений.',
    ],
  ),
  subscriptions: combine(
    [
      'Повторяющиеся платежи заметно сужают бюджетную гибкость.',
      'Подписки работают как скрытый фиксированный слой затрат.',
      'Регулярные списания ограничивают пространство для тактических решений.',
      'Фиксированные обязательства в этом месяце усилили давление на маржу.',
    ],
    [
      'Быстрый аудит полезности сервисов даст заметный эффект уже в ближайшие недели.',
      'Оптимизация тарифов и отказ от слабых по ценности подписок вернёт часть ликвидности.',
    ],
  ),
  goals: combine(
    [
      'Цели сформулированы корректно, теперь ключевым становится темп исполнения.',
      'Стратегическая рамка выглядит логично; результат определит регулярность действий.',
      'Качество целей хорошее, и следующий шаг — перевести их в недельный цикл.',
      'Текущий месяц даёт достаточно данных, чтобы сделать цели операционными.',
    ],
    [
      'Короткие контрольные точки уменьшают отклонение от плана.',
      'Привязка к календарю повышает вероятность фактического выполнения.',
    ],
  ),
  cashflow: combine(
    [
      'Итоговый денежный результат периода составил {netAmount}.',
      'Конечный баланс денежного потока за месяц — около {netAmount}.',
      'Операционный итог в {monthName} фиксируется на уровне {netAmount}.',
      'Ключевой показатель периода по денежному потоку: {netAmount}.',
    ],
    [
      'Стабилизация календаря платежей может улучшить результат без роста дохода.',
      'Недельное управление потоком снизит напряжение внутри месяца.',
    ],
  ),
  debt: combine(
    [
      'Нагрузка по долгам по-прежнему ограничивает свободу бюджетных решений.',
      'График погашений создаёт дополнительное давление на ликвидность.',
      'Сервис долга сужает пространство для накоплений и гибких расходов.',
      'Долговой контур в этом месяце требует более строгой последовательности выплат.',
    ],
    [
      'Приоритет погашения дорогих обязательств обычно даёт самый быстрый эффект.',
      'Синхронизация дат платежей с поступлениями снижает риск штрафов и просрочек.',
    ],
  ),
  investing: combine(
    [
      'Текущая конфигурация позволяет действовать в инвестициях более системно.',
      'Есть база для постепенного расширения инвестиционной части при сохранении резерва.',
      'В этом цикле инвестиционные решения лучше переводить в правило, а не в импульс.',
      'Профиль допускает поэтапное распределение капитала при контроле риска.',
    ],
    [
      'Диверсификация и поэтапный вход должны оставаться базовым стандартом.',
      'Важно не снижать ликвидность ниже безопасного уровня при росте портфеля.',
    ],
  ),
  budgeting: combine(
    [
      'По части бюджетных лимитов появились зоны повышенного давления.',
      'Скорость использования лимитов в отдельных категориях растёт.',
      'Каркас бюджета ещё управляем, но окно для ранних корректировок сужается.',
      'Профиль исполнения лимитов в этом месяце требует более плотного контроля.',
    ],
    [
      '{overBudgetCount} превышений и {nearBudgetCount} близких к лимиту категорий требуют структурных мер.',
      'Разделение месячных лимитов на недельные обычно снижает риск перерасхода.',
    ],
  ),
};

const ruFindings: Record<CategoryKey, string[]> = {
  spending: combine(
    [
      'Категория {topCategory} сейчас оказывает наибольшее влияние на общий расход.',
      'Концентрация трат в {topCategory} определяет итоговую траекторию месяца.',
      'Основное отклонение расходов формируется через {topCategory}.',
      'Самая активная расходная зона текущего цикла — {topCategory}.',
    ],
    [
      'При темпе {spendDeltaPct}% маржа может заметно снизиться без корректировки.',
      'Точечный контроль этой категории даст эффект быстрее, чем общие ограничения.',
    ],
  ),
  income: combine(
    [
      'Изменение дохода уже достаточно значимо для пересборки сценариев.',
      'Сдвиг входящего потока на {incomeDeltaPct}% влияет на устойчивость плана.',
      'Профиль дохода становится ключевой переменной для месячного цикла.',
      'Динамика поступлений теперь напрямую связана с качеством исполнения бюджета.',
    ],
    [
      'Планирование с запасом повысит устойчивость при следующем колебании.',
      'Нужно учитывать вариативность дохода как отдельный риск-фактор.',
    ],
  ),
  savings: combine(
    [
      'Норма сбережений на уровне {savingsRatePct}% уже даёт опору для роста.',
      'Текущая линия накоплений стабильна и поддаётся дальнейшей настройке.',
      'В этом периоде видно, что модель сбережений работает, но требует усиления ритма.',
      'Данные подтверждают положительный тренд в накоплениях.',
    ],
    [
      'К цели {targetSavingsRatePct}% быстрее ведёт регулярность, а не разовые усилия.',
      'Малые регулярные шаги обычно дают более высокий процент выполнения плана.',
    ],
  ),
  risk: combine(
    [
      'Риск формируется через повторяющиеся модели поведения, а не единичные операции.',
      'Ведущие риск-маркеры проявляются до фактического перерасхода.',
      'Профиль риска контролируем, но требует более ранних управляющих действий.',
      'Сигналы риска сейчас в основном операционные и корректируемые.',
    ],
    [
      'Ранний контроль даёт лучший результат, чем поздняя компенсация.',
      'Критично сократить задержку между сигналом и действием.',
    ],
  ),
  subscriptions: combine(
    [
      'Повторяющиеся платежи ограничивают пространство для адаптивных решений.',
      'Фиксированные подписки работают как постоянный тормоз гибкости.',
      'Слой регулярных расходов снижает доступный резерв внутри месяца.',
      'Накопленный эффект подписок заметно давит на операционный баланс.',
    ],
    [
      'Быстрая ревизия ценности сервисов даст практический эффект уже сейчас.',
      'Очистка слабополезных подписок повысит устойчивость без резких сокращений.',
    ],
  ),
  goals: combine(
    [
      'Целевая часть сформирована, осталось усилить ритм практической реализации.',
      'Главное ограничение сейчас — не стратегия, а регулярность исполнения.',
      'Цели достаточно конкретны для измеримого недельного контроля.',
      'Система целей готова к переводу в операционный режим.',
    ],
    [
      'Недельные вехи существенно снижают риск отклонения.',
      'Календарная привязка действий повышает дисциплину исполнения.',
    ],
  ),
  cashflow: combine(
    [
      'Ключевой результат по денежному потоку: {netAmount}.',
      'Итоговое значение cashflow за период — {netAmount}.',
      'Операционный баланс месяца закрылся около {netAmount}.',
      'Текущая точка денежного баланса: {netAmount}.',
    ],
    [
      'Даже без изменения дохода это можно улучшить за счёт календаря платежей.',
      'Недельная балансировка потока снижает внутреннюю волатильность.',
    ],
  ),
  debt: combine(
    [
      'Долговая нагрузка остаётся значимым ограничителем ликвидности.',
      'Платежи по долгам заметно сужают пространство для манёвра.',
      'Сервис долга напрямую конкурирует с возможностью наращивать накопления.',
      'Текущий контур выплат требует более чёткого приоритета.',
    ],
    [
      'Фокус на дорогих обязательствах обычно быстрее снижает общий расход.',
      'Синхронизация графика выплат с поступлениями уменьшает операционный риск.',
    ],
  ),
  investing: combine(
    [
      'Инвестиционная часть может быть усилена за счёт системного подхода.',
      'Сейчас разумно переходить к поэтапной модели формирования портфеля.',
      'Профиль допускает аккуратное расширение инвестиций при сохранении буфера.',
      'Условия месяца поддерживают дисциплинированную, а не импульсную стратегию.',
    ],
    [
      'Поэтапный вход и диверсификация должны оставаться обязательными.',
      'Важно сохранять резерв ликвидности на фоне роста инвестиционной доли.',
    ],
  ),
  budgeting: combine(
    [
      'По лимитам категорий видны ранние сигналы перегрева.',
      'Скорость расходования лимитов повышает риск перерасхода к концу месяца.',
      'Структура бюджета требует более частой корректировки по факту.',
      'Контроль лимитов остаётся ключевым узлом текущего цикла.',
    ],
    [
      '{overBudgetCount} превышений и {nearBudgetCount} пограничных категорий подтверждают необходимость действий.',
      'Недельные подлимиты обычно лучше удерживают бюджет в допустимом коридоре.',
    ],
  ),
};

const ruActions: Record<CategoryKey, string[]> = {
  spending: combine(
    [
      'Задай дневной лимит для {topCategory} и отслеживай его в недельном срезе.',
      'На 7 дней введи верхний порог на одну операцию в категории {topCategory}.',
      'Сгруппируй покупки по {topCategory} в фиксированные окна, чтобы снизить импульсные траты.',
      'Сдвинь уведомления по {topCategory} на более ранний порог.',
    ],
    [
      'Это позволит быстрее погасить отклонение на уровне {spendDeltaPct}%.',
      'Такой шаг обычно даёт быстрый контроль без резкого ужесточения.',
    ],
  ),
  income: combine(
    [
      'В день поступления дохода автоматизируй распределение на операционный и резервный контуры.',
      'При нестабильном доходе веди бюджет в двух сценариях: базовом и консервативном.',
      'Не повышай постоянные обязательства сразу после роста дохода.',
      'Дополнительный доход сначала направляй в резерв и снижение долговой нагрузки.',
    ],
    [
      'Это повысит устойчивость при колебаниях {incomeDeltaPct}%.',
      'Так сохраняется качество исполнения без избыточной жёсткости.',
    ],
  ),
  savings: combine(
    [
      'Запусти фиксированный еженедельный перевод в накопления без ручного решения.',
      'Разбей месячную цель по сбережениям на короткие недельные этапы.',
      'Сначала выполняй перевод в накопления, затем открывай discretionary-расходы.',
      'Установи минимальный автоперевод, который выполняется каждую неделю.',
    ],
    [
      'Так проще перейти от {savingsRatePct}% к целевому уровню {targetSavingsRatePct}%.',
      'Регулярность в этом вопросе важнее размера разового шага.',
    ],
  ),
  risk: combine(
    [
      'Снизь пороги оповещений в категориях с высокой волатильностью.',
      'Добавь промежуточную проверку перед повторяющимися необязательными платежами.',
      'Вынеси риск-категории в отдельный недельный контрольный лист.',
      'Проведи 7-дневный спринт по трём ключевым контрольным метрикам.',
    ],
    [
      'Это сократит задержку реакции и не даст риску накапливаться.',
      'Раннее управление обычно эффективнее поздних компенсаций.',
    ],
  ),
  subscriptions: combine(
    [
      'Проведи ревизию подписок по критериям полезности, частоты и заменяемости.',
      'Приостанови хотя бы одну подписку с низким фактическим использованием.',
      'Сравни тарифы и снизь переоценённые регулярные планы.',
      'Объедини пересекающиеся сервисы в один более экономичный вариант.',
    ],
    [
      'Это быстро вернёт гибкость без существенного дискомфорта.',
      'Оптимизация фиксированных затрат обычно даёт мгновенный эффект.',
    ],
  ),
  goals: combine(
    [
      'Разложи месячные цели на недельные шаги и зафиксируй их в календаре.',
      'Выдели две цели с максимальным эффектом и временно отложи второстепенные.',
      'Запусти еженедельный 10-минутный ритуал проверки прогресса.',
      'Собери простой дашборд целей с бинарной отметкой выполнения.',
    ],
    [
      'Так прогресс становится видимым и управляемым.',
      'Эта структура заметно уменьшает отклонение от плана.',
    ],
  ),
  cashflow: combine(
    [
      'Синхронизируй даты крупных платежей с окнами поступлений.',
      'Распредели крупные расходы по неделям, а не концентрируй в одном интервале.',
      'Установи порог минимального остатка по операционному счёту.',
      'Планируй приоритетные списания сразу после даты поступления дохода.',
    ],
    [
      'Это сделает результат {netAmount} более предсказуемым.',
      'Оптимизация календаря часто снижает стресс быстрее, чем простое сокращение трат.',
    ],
  ),
  debt: combine(
    [
      'Отсортируй долговые обязательства по эффективной стоимости и плати в этом порядке.',
      'Автоматизируй минимальные платежи вблизи дат поступления дохода.',
      'Дополнительные выплаты направляй сначала в самый дорогой долг.',
      'Перейди на недельный контроль прогресса по погашению.',
    ],
    [
      'Это ускоряет снижение общей долговой нагрузки.',
      'Так уменьшаются риски штрафов и кассовых разрывов.',
    ],
  ),
  investing: combine(
    [
      'Используй поэтапные регулярные входы вместо крупных разовых сделок.',
      'Снижай концентрацию, расширяя диверсификацию по инструментам.',
      'Перед новой инвестицией проверяй сохранность ликвидного резерва.',
      'Запланируй квартальный пересмотр портфеля с лимитами риска.',
    ],
    [
      'Это повышает устойчивость без потери долгосрочного потенциала.',
      'Последовательность и диверсификация остаются главным преимуществом.',
    ],
  ),
  budgeting: combine(
    [
      'Введи недельные подлимиты для категорий в зоне риска.',
      'Смести триггеры уведомлений на уровень 80% использования лимита.',
      'Пересобери лимиты по фактической динамике последних трёх месяцев.',
      'Добавь ограничение на размер одной операции в перегретых категориях.',
    ],
    [
      'Это адресует {overBudgetCount} превышений и {nearBudgetCount} пограничных сигналов.',
      'С таким ритмом риск перерасхода к концу месяца заметно снижается.',
    ],
  ),
};

const ruGenericAdviceSummaries = combine(
  [
    '{monthName} подтверждает: системность работает лучше разовых усилий.',
    'Текущий финансовый профиль управляем при дисциплине еженедельного контроля.',
    'Данные месяца показывают, что небольшие регулярные корректировки дают лучший эффект.',
    'Сейчас важнее качество процесса, чем точечные резкие решения.',
  ],
  [
    'Сфокусируйся сначала на двух действиях с максимальным влиянием.',
    'Автоматизация рутинных решений сохранит темп и снизит ошибки.',
    'Переход к недельному ритму управления даст более стабильный результат.',
    'Измеримость шагов повышает вероятность фактического выполнения.',
  ],
);

const ruGenericFindings = combine(
  [
    'Поведенческие паттерны сейчас влияют на итог сильнее, чем отдельные операции.',
    'Ранние сигналы отклонения видны до критического перерасхода.',
    'Частота и тайминг операций формируют результат не меньше, чем суммы.',
    'Ключевой фактор устойчивости — ритм исполнения финансовых решений.',
  ],
  [
    'Это можно скорректировать простыми управленческими правилами.',
    'Быстрые точечные меры дадут заметный эффект уже в текущем цикле.',
    'Для улучшения не требуется радикально менять образ жизни.',
    'Еженедельная прозрачность существенно снижает риск срыва плана.',
  ],
);

const ruGenericActions = combine(
  [
    'Запланируй еженедельный 10-минутный финансовый обзор в фиксированное время.',
    'На ближайшие две недели отслеживай только три ключевые контрольные метрики.',
    'Максимально переведи повторяющиеся решения в автоматические правила.',
    'Применяй правило паузы 24 часа для необязательных покупок.',
  ],
  [
    'Это быстро улучшает качество решений.',
    'Такой подход снижает вариативность результата в пределах одного цикла.',
    'Схема достаточно простая, чтобы удерживать её без перегрузки.',
    'Финансовый контроль усиливается при меньшем уровне стресса.',
  ],
);

export const templateBankRu: TemplateBank = {
  adviceSummaries: ruAdviceSummaries,
  findings: ruFindings,
  actions: ruActions,
  generic: {
    adviceSummaries: ruGenericAdviceSummaries,
    findings: ruGenericFindings,
    actions: ruGenericActions,
  },
};

